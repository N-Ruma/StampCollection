{% extends "base.html" %}
{% load static %}

{% block head %}
<link rel="stylesheet" href="{% static 'css/style.css' %}">
<!-- Leaflet & JavaScript CSS -->
<link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY=" crossorigin=""/>
<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js" integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo=" crossorigin=""></script>
{% endblock head %}

{% block title %}
<h1>Leaflet & OpenStreetMap</h1>
{% endblock title %}

{% block content %}
<div id="map"></div>
{% endblock content %}

{% block redirect %}
<a href="{% url 'home' %}">ホーム</a>
{% endblock redirect %}

{% block script %}
<script>
// 六本木を中心に地図描画
function init_map() {
  const map = L.map("map");
  map.setView([42.378, 141.034], 17); 

  // OpenStreetMap から地図画像を読み込む
  L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
    attribution: '© <a href="http://osm.org/copyright">OpenStreetMap</a> contributors, <a href="http://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>',
  }).addTo(map);

  L.marker([42.377051086206244, 141.03338778005974])
      .on('contextmenu', function(e){
      window.open( "https://www.google.co.jp/maps/place/"+e.latlng.lat+","+e.latlng.lng+"/@"+e.latlng.lat+","+e.latlng.lng+",15z/data");
    })
    .addTo(map);
  L.marker([42.37912946408624, 141.0350117909684])
    .on('contextmenu', function(e){
      window.open( "https://www.google.co.jp/maps/place/"+e.latlng.lat+","+e.latlng.lng+"/@"+e.latlng.lat+","+e.latlng.lng+",15z/data");
    })
    .addTo(map);
}

//ダウンロード時に初期化する
window.addEventListener("DOMContentLoaded", init_map())
</script>
{% endblock script %}